<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Le Dee dentro di Lei</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'blue-dea': '#3b82f6',
            'green-dea': '#10b981',
            'red-dea': '#ef4444',
            'yellow-dea': '#f59e0b',
            'violet-dea': '#8b5cf6',
            'brown-dea': '#78350f',
            'black-dea': '#111827'
          }
        }
      }
    }
  </script>

  <style>
    .drag-handle { cursor: move; user-select: none; }
    .dea-card { transition: transform .2s, box-shadow .2s; }
    .dea-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(0,0,0,.1);
    }
  </style>
</head>

<body class="bg-gradient-to-br from-indigo-50 to-purple-100 min-h-screen p-6">

<div class="max-w-4xl mx-auto">

  <!-- TITOLO -->
  <h1 class="text-4xl font-bold text-center mb-4">Le Dee dentro di Lei</h1>
  <p class="text-center text-gray-600 mb-8">
    Scegli come vuoi procedere:
  </p>

  <!-- SCELTA -->
  <div id="scelta" class="space-y-4 text-center">
    <button id="btnTest" class="block w-full max-w-md mx-auto p-4 bg-white rounded shadow">
      <strong>1. Fai il test</strong><br>
      Scopri la tua sequenza di dee rispondendo a 36 domande
    </button>

    <button id="btnOrdina" class="block w-full max-w-md mx-auto p-4 bg-white rounded shadow">
      <strong>2. Ordina manualmente</strong><br>
      Se conosci gi√† le dee, ordinale direttamente
    </button>
  </div>

  <!-- TEST (versione base funzionante, compatibile) -->
  <div id="test" class="hidden mt-10">
    <form id="quizForm" class="space-y-6">
      <p class="text-center text-gray-600">Versione test (36 domande ‚Äì base)</p>

      <div class="question">
        <p class="font-semibold">1. Cosa guida di pi√π le tue scelte?</p>
        <label><input type="radio" name="q1" value="Afrodite"> Desiderio</label><br>
        <label><input type="radio" name="q1" value="Atena"> Razionalit√†</label><br>
        <label><input type="radio" name="q1" value="Artemide"> Libert√†</label><br>
        <label><input type="radio" name="q1" value="Demetra"> Cura</label><br>
        <label><input type="radio" name="q1" value="Era"> Impegno</label><br>
        <label><input type="radio" name="q1" value="Persefone"> Trasformazione</label><br>
        <label><input type="radio" name="q1" value="Estia"> Interiorit√†</label>
      </div>

      <button type="button" onclick="processaTest()"
        class="bg-blue-dea text-white px-6 py-2 rounded">
        Scopri la tua Anima
      </button>
    </form>
  </div>

  <!-- ORDINAMENTO MANUALE -->
  <div id="ordinamento" class="hidden mt-10">
    <p class="text-lg text-gray-600 text-center mb-6">
      Ordina le sette dee in base alla tua preferenza
    </p>

    <div id="dea-list" class="space-y-3 mb-8"></div>

    <div class="text-center">
      <button onclick="analizza()"
        class="bg-blue-dea hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg shadow">
        Scopri la tua Anima
      </button>
    </div>
  </div>

  <!-- RISULTATO -->
  <div id="result" class="hidden mt-10 p-6 bg-white rounded-lg shadow">
    <h2 class="text-2xl font-bold mb-4">La tua Anima</h2>
    <div id="analysis" class="space-y-4 text-gray-700"></div>
  </div>

</div>

<script>
/* ================= DATI ================= */
const dee = [
  { id: 1, nome: "Persefone", simbolo: "üå∏", colore: "violet-dea", descr: "Ricettivit√†, trasformazione" },
  { id: 2, nome: "Afrodite", simbolo: "üåπ", colore: "red-dea", descr: "Sensualit√†, bellezza" },
  { id: 3, nome: "Artemide", simbolo: "üåô", colore: "blue-dea", descr: "Indipendenza" },
  { id: 4, nome: "Era", simbolo: "üëë", colore: "yellow-dea", descr: "Impegno relazionale" },
  { id: 5, nome: "Demetra", simbolo: "üåæ", colore: "brown-dea", descr: "Nutrimento" },
  { id: 6, nome: "Atena", simbolo: "üõ°Ô∏è", colore: "green-dea", descr: "Saggezza" },
  { id: 7, nome: "Estia", simbolo: "üî•", colore: "black-dea", descr: "Interiorit√†" }
];

/* ================= SCELTA ================= */
btnTest.onclick = () => {
  scelta.classList.add("hidden");
  test.classList.remove("hidden");
};

btnOrdina.onclick = () => {
  scelta.classList.add("hidden");
  ordinamento.classList.remove("hidden");
  caricaDee();
};

/* ================= TEST ================= */
function processaTest() {
  const punteggi = {};
  dee.forEach(d => punteggi[d.nome] = 0);

  document.querySelectorAll("input[type=radio]:checked")
    .forEach(r => punteggi[r.value]++);

  const ordine = Object.keys(punteggi)
    .sort((a,b) => punteggi[b] - punteggi[a]);

  mostraRisultato(ordine);
}

/* ================= ORDINAMENTO ================= */
let dragSrcEl = null;

function caricaDee() {
  const list = document.getElementById("dea-list");
  list.innerHTML = "";

  [...dee].sort(() => Math.random() - .5).forEach(dea => {
    const div = document.createElement("div");
    div.className = `dea-card flex items-center p-4 bg-white rounded-lg shadow cursor-move border-l-4 border-${dea.colore}`;
    div.draggable = true;
    div.dataset.id = dea.id;
    div.innerHTML = `
      <span class="drag-handle text-xl mr-4">‚ò∞</span>
      <span class="text-2xl mr-3">${dea.simbolo}</span>
      <div>
        <div class="font-bold">${dea.nome}</div>
        <div class="text-sm text-gray-500">${dea.descr}</div>
      </div>`;
    div.addEventListener("dragstart", handleDragStart);
    div.addEventListener("dragover", e => e.preventDefault());
    div.addEventListener("drop", handleDrop);
    list.appendChild(div);
  });
}

function handleDragStart(e) {
  dragSrcEl = this;
  e.dataTransfer.setData("text/plain", "");
}

function handleDrop(e) {
  e.preventDefault();
  if (dragSrcEl !== this) {
    const src = dragSrcEl.outerHTML;
    dragSrcEl.outerHTML = this.outerHTML;
    this.outerHTML = src;
    caricaDee();
  }
}

/* ================= ANALISI ================= */
function analizza() {
  const ordine = [...document.querySelectorAll(".dea-card")]
    .map(el => dee.find(d => d.id == el.dataset.id).nome);
  mostraRisultato(ordine);
}

function mostraRisultato(ordine) {
  ordinamento.classList.add("hidden");
  test.classList.add("hidden");
  result.classList.remove("hidden");
  analysis.innerHTML = ordine.map((d,i)=>`<p>${i+1}. ${d}</p>`).join("");
}
</script>

</body>
</html>
