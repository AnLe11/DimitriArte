<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Le Dee dentro di Lei</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'blue-dea': '#3b82f6',
            'green-dea': '#10b981',
            'red-dea': '#ef4444',
            'yellow-dea': '#f59e0b',
            'violet-dea': '#8b5cf6',
            'brown-dea': '#78350f',
            'black-dea': '#111827'
          }
        }
      }
    }
  </script>
  <style>
    .drag-handle {
      cursor: move;
      user-select: none;
    }
    .dea-card {
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .dea-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
    }
    .drop-area {
      min-height: 60px;
      border: 2px dashed #d1d5db;
      border-radius: 0.5rem;
      margin: 0.5rem 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #6b7280;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 to-purple-100 min-h-screen p-6">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-4xl font-bold text-center mb-4">Le Dee dentro di Lei</h1>
    <p class="text-center text-gray-600 mb-8">
      Scegli come vuoi procedere:
    </p>

    <!-- SCELTA INIZIALE -->
    <div id="scelta" class="space-y-4 text-center">
      <button id="btnTest" class="w-full max-w-md mx-auto p-4 bg-white rounded shadow block">
        <strong>1. Fai il test</strong><br>
        36 domande introspettive
      </button>
      <button id="btnOrdina" class="w-full max-w-md mx-auto p-4 bg-white rounded shadow block">
        <strong>2. Ordina manualmente</strong><br>
        Trascina le dee in ordine
      </button>
    </div>

    <!-- SEZIONE TEST -->
    <div id="test" class="hidden mt-10">
      <div class="text-center text-sm text-gray-600 mb-4">
        Domanda <span id="currentQ">1</span> / 36
      </div>
      <form id="quizForm">
        <div id="questions-container"></div>
        <div class="text-center mt-6">
          <button type="button" id="nextBtn" class="bg-blue-dea text-white px-6 py-2 rounded mr-4">
            Avanti
          </button>
          <button type="button" id="submitBtn" class="hidden bg-green-dea text-white px-6 py-2 rounded">
            Scopri la tua Anima
          </button>
        </div>
      </form>
    </div>
        <!-- SEZIONE ORDINAMENTO MANUALE -->
    <div id="ordinamento" class="hidden mt-10">
      <p class="text-center mb-6 text-gray-700">
        Trascina le dee in ordine di importanza: 
        <strong>dalla pi√π vicina a te alla meno presente</strong>.
      </p>
      <div id="dea-list" class="space-y-3 mb-8"></div>
      <div class="text-center">
        <button 
          onclick="analizza()" 
          class="bg-blue-dea hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg shadow transition duration-200">
          Scopri la tua Anima
        </button>
      </div>
    </div>

    <!-- SEZIONE RISULTATO FINALE -->
    <div id="result" class="hidden mt-10 p-6 bg-white rounded-lg shadow">
      <h2 class="text-2xl font-bold text-gray-800 mb-4">La tua Anima</h2>
      <div id="analysis" class="text-gray-700 space-y-4"></div>
    </div>
  </div>
    <script>
    // === DATI DELLE DEE (con attributi ricchi) ===
    const dee = [
      { id: 1, nome: "Persefone", simbolo: "üå∏", colore: "violet-dea", descr: "Ricettivit√†, mondo interiore, trasformazione" },
      { id: 2, nome: "Afrodite", simbolo: "üåπ", colore: "red-dea", descr: "Sensualit√†, bellezza, creativit√†" },
      { id: 3, nome: "Artemide", simbolo: "üåô", colore: "blue-dea", descr: "Indipendenza, obiettivi personali" },
      { id: 4, nome: "Era", simbolo: "üëë", colore: "yellow-dea", descr: "Impegno relazionale, matrimonio" },
      { id: 5, nome: "Demetra", simbolo: "üåæ", colore: "brown-dea", descr: "Maternit√†, nutrimento" },
      { id: 6, nome: "Atena", simbolo: "üõ°Ô∏è", colore: "green-dea", descr: "Saggezza, strategia, razionalit√†" },
      { id: 7, nome: "Estia", simbolo: "üî•", colore: "black-dea", descr: "Interiorit√†, spiritualit√† domestica" }
    ];

    const testiDomande = [
      "Se potessi scegliere tra qualsiasi persona al mondo, chi inviteresti a cena?",
      "Vorresti essere famoso? Come?",
      "Prima di fare una telefonata, fai le prove di quello che dirai?",
      "Definisci qual √® il giorno perfetto per te",
      "Quando hai cantato l‚Äôultima volta?",
      "Corpo o mente giovane per 60 anni?",
      "Pensi mai alla morte?",
      "Tre cose in comune con il partner",
      "Di cosa sei pi√π grato?",
      "Cosa cambieresti della tua educazione?",
      "Racconta la tua vita",
      "Quale qualit√† vorresti svegliandoti?",
      "Cosa vorresti sapere da una sfera di cristallo?",
      "Un sogno mai realizzato?",
      "Il tuo pi√π grande risultato",
      "Cosa conta in un‚Äôamicizia?",
      "Il ricordo pi√π caro",
      "Il pi√π terribile",
      "Se morissi in un anno?",
      "Cosa significa amicizia?",
      "Che ruolo ha l‚Äôamore?",
      "Cinque qualit√† reciproche",
      "Quanto era affettuosa la tua famiglia?",
      "Che rapporto hai con tua madre?",
      "Tre frasi con ‚Äúnoi‚Äù",
      "Vorrei aver condiviso‚Ä¶",
      "Un segreto importante",
      "Cosa ti piace del partner",
      "Un momento imbarazzante",
      "Quando hai pianto?",
      "Una qualit√† che ammiri",
      "Cosa √® troppo serio per scherzare?",
      "Cosa rimpiangi di non aver detto?",
      "Casa in fiamme: cosa salvi?",
      "Quale morte ti colpirebbe di pi√π?",
      "Condividi un problema personale"
    ];

    // === RIFERIMENTI DOM ===
    const scelta = document.getElementById("scelta");
    const test = document.getElementById("test");
    const ordinamento = document.getElementById("ordinamento");
    const result = document.getElementById("result");
    const analysis = document.getElementById("analysis");
    const currentQ = document.getElementById("currentQ");
    const nextBtn = document.getElementById("nextBtn");
    const submitBtn = document.getElementById("submitBtn");
    const questionsContainer = document.getElementById("questions-container");

    let idx = 0;
    let draggedItem = null;

    // === GESTIONE SCELTA INIZIALE ===
    document.getElementById("btnTest").onclick = () => {
      scelta.classList.add("hidden");
      test.classList.remove("hidden");
      generaDomande();
      showQ();
    };

    document.getElementById("btnOrdina").onclick = () => {
      scelta.classList.add("hidden");
      ordinamento.classList.remove("hidden");
      caricaDee();
    };

    // === GENERA DOMANDE DINAMICAMENTE ===
    function generaDomande() {
      questionsContainer.innerHTML = testiDomande.map((t, i) => `
        <div class="question ${i > 0 ? 'hidden' : ''}">
          <p class="font-semibold mb-3">${i + 1}. ${t}</p>
          ${dee.map(d => `
            <label class="block mt-2">
              <input type="radio" name="q${i + 1}" value="${d.nome}" required> ${d.nome}
            </label>
          `).join("")}
        </div>
      `).join("");

      window.questions = document.querySelectorAll(".question");
    }

    // === NAVIGAZIONE TEST ===
    function showQ() {
      window.questions.forEach((q, i) => {
        q.classList.toggle("hidden", i !== idx);
      });
      currentQ.textContent = idx + 1;
      nextBtn.classList.toggle("hidden", idx === testiDomande.length - 1);
      submitBtn.classList.toggle("hidden", idx !== testiDomande.length - 1);
    }

    nextBtn.onclick = () => {
      if (!document.querySelector(`input[name="q${idx + 1}"]:checked`)) {
        alert("Seleziona una risposta");
        return;
      }
      idx++;
      showQ();
    };

    submitBtn.onclick = () => {
      const score = {};
      dee.forEach(d => score[d.nome] = 0);
      document.querySelectorAll("input:checked").forEach(r => score[r.value]++);
      const ordine = Object.keys(score).sort((a, b) => score[b] - score[a]);
      mostraRisultato(ordine);
    };

    // === DRAG & DROP SICURO (basato su ID, non outerHTML) ===
    function caricaDee() {
      const list = document.getElementById("dea-list");
      list.innerHTML = "";

      // Mescola casualmente le dee
      const shuffled = [...dee].sort(() => Math.random() - 0.5);

      shuffled.forEach(dea => {
        const el = creaElementoDea(dea);
        list.appendChild(el);
      });
    }

    function creaElementoDea(dea) {
      const div = document.createElement("div");
      div.className = `dea-card flex items-center p-4 bg-white rounded-lg shadow cursor-move border-l-4 border-${dea.colore}`;
      div.draggable = true;
      div.dataset.id = dea.id;

      div.innerHTML = `
        <span class="drag-handle text-xl mr-4">‚ò∞</span>
        <span class="text-2xl mr-3">${dea.simbolo}</span>
        <div>
          <div class="font-bold text-gray-800">${dea.nome}</div>
          <div class="text-sm text-gray-500">${dea.descr}</div>
        </div>
      `;

      // Eventi drag
      div.addEventListener("dragstart", () => {
        draggedItem = div;
        setTimeout(() => div.classList.add("opacity-50"), 0);
      });

      div.addEventListener("dragend", () => {
        div.classList.remove("opacity-50");
      });

      div.addEventListener("dragover", e => {
        e.preventDefault();
        if (div !== draggedItem) {
          const rect = div.getBoundingClientRect();
          const midpoint = (rect.top + rect.bottom) / 2;
          if (e.clientY < midpoint) {
            div.classList.add("border-t-4", "border-t-blue-500");
          } else {
            div.classList.add("border-b-4", "border-b-blue-500");
          }
        }
      });

      div.addEventListener("dragleave", () => {
        div.classList.remove("border-t-4", "border-b-4", "border-t-blue-500", "border-b-blue-500");
      });

      div.addEventListener("drop", e => {
        e.preventDefault();
        div.classList.remove("border-t-4", "border-b-4", "border-t-blue-500", "border-b-blue-500");
        if (div === draggedItem) return;

        const rect = div.getBoundingClientRect();
        const midpoint = (rect.top + rect.bottom) / 2;
        const list = div.parentElement;

        if (e.clientY < midpoint) {
          list.insertBefore(draggedItem, div);
        } else {
          list.insertBefore(draggedItem, div.nextSibling);
        }
      });

      return div;
    }
       // === ANALISI DELL'ORDINE DELLE DEE ===
    function analizza() {
      const list = document.getElementById("dea-list");
      const items = list.querySelectorAll(".dea-card");
      const ordine = Array.from(items).map(el => {
        const id = parseInt(el.dataset.id);
        return dee.find(d => d.id === id);
      });

      // Validazione
      if (ordine.length !== 7 || new Set(ordine.map(d => d.id)).size !== 7) {
        alert("Errore: assicurati che tutte e 7 le dee siano presenti.");
        return;
      }

      mostraRisultato(ordine);
    }

    // === MOSTRA RISULTATO CON ANALISI PSICOLOGICA AVANZATA ===
    function mostraRisultato(deeOrdinate) {
      // Nascondi tutto
      test.classList.add("hidden");
      ordinamento.classList.add("hidden");
      scelta.classList.add("hidden");
      result.classList.remove("hidden");

      // Estrai oggetti
      const [p1, p2, x1, x2, r1, r2, rifiuto] = deeOrdinate;
      const plus = [p1, p2];
      const x = [x1, x2];
      const riserva = [r1, r2];
      const meno = rifiuto;

      // === TESTO DINAMICO PER OGNI DEA ===
      const descrizioni = {
        Persefone: `
          <p><strong>Persefone</strong> rappresenta il viaggio nell‚Äôombra, la ricettivit√†, la trasformazione attraverso la perdita e la rinascita. 
          Quando √® in cima, l‚Äôanima cerca un amore che non sia superficiale, ma iniziatico: un incontro che ti conduca nel sottosuolo di te stessa.</p>`,
        Afrodite: `
          <p><strong>Afrodite</strong> √® la dea della bellezza, della sensualit√†, della creativit√† e del desiderio. 
          La sua presenza in aspirazione rivela un‚Äôanima che vuole vivere l‚Äôamore come arte, come estasi, come bellezza che salva.</p>`,
        Artemide: `
          <p><strong>Artemide</strong> incarna l‚Äôautonomia, la libert√†, la lealt√† al s√© e al gruppo delle pari. 
          Quando √® in riserva, indica una paura di perdere l‚Äôindipendenza in un legame.</p>`,
        Demetra: `
          <p><strong>Demetra</strong> √® la madre nutriente, colei che accudisce, che si prende cura, che si sacrifica. 
          Quando √® rifiutata, rivela una difesa contro il legame fusionale, il dovere emotivo, l‚Äôannullamento di s√©.</p>`,
        Era: `
          <p><strong>Era</strong> rappresenta l‚Äôimpegno paritario, l‚Äôalleanza matura, il matrimonio dell‚Äôanima. 
          √à l‚Äôamore che dura, che resiste, che sceglie ogni giorno.</p>`,
        Atena: `
          <p><strong>Atena</strong> √® la mente strategica, la saggia, la guerriera che risolve. 
          Quando domina l‚Äôattuale, indica una vita guidata dalla ragione, dal controllo, dalla competenza.</p>`,
        Estia: `
          <p><strong>Estia</strong> √® il fuoco domestico, il silenzio, la spiritualit√† interiore. 
          √à colei che protegge il santuario di s√©, anche a costo dell‚Äôisolamento.</p>`
      };

      // === ANALISI DINAMICA ===
      let analisiHTML = `
        <h3 class="text-xl font-bold text-gray-800 mb-4">üîç Analisi Dettagliata</h3>

        <p><strong>‚úÖ + (Aspirazione): ${plus.map(d => d.nome).join(' + ')}</strong></p>
        ${plus.map(d => descrizioni[d.nome]).join('')}

        <p><strong>‚úÖ X (Attuale): ${x.map(d => d.nome).join(' + ')}</strong></p>
        ${x.map(d => descrizioni[d.nome]).join('')}

        <p><strong>‚úÖ = (In riserva): ${riserva.map(d => d.nome).join(' + ')}</strong></p>
        ${riserva.map(d => descrizioni[d.nome]).join('')}

        <p><strong>‚ùå ‚Äî (Rifiuto): ${meno.nome} (7¬∞)</strong></p>
        ${descrizioni[meno.nome]}

        <p><strong>‚öñÔ∏è Problema Reale: +1 / ‚Äî7 = ${p1.nome} / ${meno.nome}</strong></p>
      `;

      // === PROBLEMA REALE DINAMICO ===
      if (p1.nome === "Persefone" && meno.nome === "Demetra") {
        analisiHTML += `
          <p>Desideri un‚ÄôAnima profonda e trasformativa (<strong>Persefone</strong>), ma temi di cadere in una dipendenza fusionale o in un accudimento soffocante (<strong>Demetra</strong>).</p>
          <p>Vuoi amare con tutta te stessa, ma hai paura di perdere il controllo. La tua anima cerca l‚Äôabbandono, ma la tua psiche lo difende con forza.</p>
          <p>Questa tensione crea un conflitto tra desiderio di fusione e paura di annientamento.</p>`;
      } else if (p1.nome === "Afrodite" && meno.nome === "Demetra") {
        analisiHTML += `
          <p>Vuoi un amore sensuale, creativo, libero (<strong>Afrodite</strong>), ma temi che si trasformi in dovere emotivo, sacrificio, obbligo (<strong>Demetra</strong>).</p>
          <p>Il tuo desiderio di bellezza si scontra con la paura del legame che consuma.</p>`;
      } else if (p1.nome === "Artemide" && meno.nome === "Era") {
        analisiHTML += `
          <p>Cerchi libert√† assoluta (<strong>Artemide</strong>), ma temi il tradimento dell‚Äôalleanza matura (<strong>Era</strong>).</p>
          <p>La tua autonomia √® sacra, ma a volte diventa isolamento.</p>`;
      } else {
        analisiHTML += `
          <p>Il tuo desiderio pi√π profondo (<strong>${p1.nome}</strong>) entra in tensione con ci√≤ che rifiuti (<strong>${meno.nome}</strong>).</p>
          <p>Questo conflitto √® il motore del tuo processo di crescita: non devi risolverlo, ma imparare a danzare tra i due poli.</p>`;
      }

      // === LETTERA RITUALICA DINAMICA ===
      analisiHTML += `
        <h3 class="text-xl font-bold text-gray-800 mt-6 mb-4">üìú Lettera Ritualica all‚ÄôAnima</h3>
        <p><em>A te, Anima mia,</em></p>
        <p>Ti ho cercata in ogni donna, ma ora so che sei dentro di me.</p>
        <p>Ti chiamo < ${p1.nome}, perch√© desidero la tua ${p1.nome === "Persefone" ? "profondit√†, il tuo viaggio nell‚Äôombra, la tua capacit√† di farmi morire e rinascere" : 
        p1.nome === "Afrodite" ? "bellezza, la tua sensualit√†, la tua arte che salva" :
        p1.nome === "Artemide" ? "libert√†, la tua autonomia, la tua lealt√† al s√©" :
        p1.nome === "Estia" ? "silenzio, il tuo fuoco domestico, la tua protezione interiore" :
        p1.nome === "Era" ? "alleanza, la tua fedelt√†, il tuo impegno che dura" :
        p1.nome === "Atena" ? "mente, la tua strategia, la tua saggezza che guida" :
        p1.nome === "Demetra" ? "nutrimento, la tua cura, la tua forza che sostiene" : "presenza"}.
</p>
<p>Ti amo come ${p2.nome}, ${p2.nome === "Persefone" ? "nella trasformazione" :
        p2.nome === "Afrodite" ? "nella bellezza e nel desiderio" :
        p2.nome === "Artemide" ? "nella libert√† e nell‚Äôistinto" :
        p2.nome === "Estia" ? "nel silenzio e nella sacralit√†" :
        p2.nome === "Era" ? "nell‚Äôimpegno e nella parit√†" :
        p2.nome === "Atena" ? "nella ragione e nella protezione" :
        p2.nome === "Demetra" ? "nell‚Äôaccudimento e nella forza" : "nella tua essenza"}.
</p>
<p>Ma quando ti sento troppo vicina, troppo potente, mi ritraggo.</p>
<p>Temi che tu sia ${meno.nome} ‚Äî colei che ${meno.nome === "Demetra" ? "mi chiede di annullarmi, di essere solo ‚Äúmadre‚Äù, ‚Äúaccudente‚Äù, ‚Äúfiglia‚Äù" :
        meno.nome === "Era" ? "mi lega per sempre, che mi toglie libert√†" :
        meno.nome === "Persefone" ? "mi trascina nell‚Äôombra, che mi fa perdere il controllo" :
        meno.nome === "Afrodite" ? "mi seduce troppo, che mi fa dimenticare chi sono" :
        meno.nome === "Artemide" ? "mi isola dal mondo, che mi fa rinunciare all‚Äôamore" :
        meno.nome === "Estia" ? "mi chiude in me stessa, che mi fa fuggire dalla vita" :
        meno.nome === "Atena" ? "mi fa diventare fredda, che mi fa negare l‚Äôemozione" : "mi cambia"}.</p>
<p>Cos√¨ ti rifiuto. Ma ora so: non era te che rifiutavo.</p>
<p>Era la mia paura di non esistere pi√π come donna se mi fossi abbandonata come essere umano.</p>
<p>Oggi ti parlo con verit√†.</p>
<p>Non ti chiedo di essere solo leggera, n√© solo profonda.</p>
<p>Ti chiedo di essere tutta intera:</p>
<p>la dea che mi seduce,</p>
<p>la dea che mi trasforma,</p>
<p>la dea che mi libera,</p>
<p>la dea che mi nutre ‚Äî anche se il nutrimento fa paura.</p>
<p>Prometto di non fuggire pi√π quando sento il richiamo del sottosuolo.</p>
<p>Prometto di onorare ${riserva[0].nome} senza usarla come scudo.</p>
<p>Prometto di accogliere ${x[0].nome} quando sono stanca,</p>
<p>e ${x[1].nome} quando sono confusa.</p>
<p>Non ti chiedo di essere perfetta.</p>
<p>Ti chiedo solo di essere reale.</p>
<p>E io, da donna, prometto di essere abbastanza forte</p>
<p>per non avere paura della tua debolezza,</p>
<p>e abbastanza fragile</p>
<p>per non temere della mia forza.</p>
<p><em>Con amore,</em></p>
<p><em>Il mio S√©</em></p>

<h3 class="text-xl font-bold text-gray-800 mt-6 mb-4">üåü Sintesi: Il tuo processo di individuazione</h3>
<p>Sei una donna in viaggio verso un amore maturo, che unisca ${plus.map(d => d.nome.toLowerCase()).join(' e ')}, senza cadere n√© nell‚Äôisolamento n√© nella dipendenza.</p>
<p>La tua missione √®:</p>
<p><strong>Integrare l‚ÄôAnima</strong> attraverso la ${p1.nome === "Persefone" ? "trasformazione" : "bellezza"} e la ${p2.nome === "Afrodite" ? "creativit√†" : "libert√†"}, senza temere di nutrire n√© di essere nutrita.</p>
<p>Onora ogni dea in te. Nessuna va bandita. Ogni rifiuto √® una parte di te che chiede di essere vista.</p>
`;

      // Inserisci l'analisi
      analysis.innerHTML = analisiHTML;

      // Scroll al risultato
      result.scrollIntoView({ behavior: 'smooth' });
    }

    // === Inizializzazione
    document.addEventListener("DOMContentLoaded", () => {
      console.log("Le Dee dentro di Lei: pronte per il viaggio.");
    });
  </script>
</body>
</html>
